{% extends "base.html" %}

{% block title %}仕入れ履歴{% endblock %}

{% block content %}
  <!-- フラッシュメッセージ表示 -->
  {% with messages = get_flashed_messages() %}
    {% if messages %}
      <div class="flash-messages">
        {% for message in messages %}
          <p>{{ message }}</p>
        {% endfor %}
      </div>
    {% endif %}
  {% endwith %}

  <h1>過去1か月の仕入れ履歴</h1>
  <table border="1" cellpadding="5">
      <tr>
          <th>ID</th>
          <th>日付</th>
          <th>商品名</th>
          <th>数量</th>
          <th>価格</th>
          <th>仕入れ先</th>
          <th>登録者</th>   <!-- ★追加 -->
          <th>操作</th>/th>
          <th>操作</th>
      </tr>
      {% for r in purchases %}
      <tr>
          <td>{{ r.id }}</td>
          <td>{{ r.purchased_at }}</td>
          <td>{{ r.item_name }}</td>
          <td>{{ r.quantity }}</td>
          <td>{{ r.price }}</td>
          <td>{{ r.supplier }}</td>
          <td>{{ r.user_name }}</td>   <!-- ★追加 -->
          <td>
            <form method="POST" action="/delete_purchase/{{ r.id }}" 
                  onsubmit="return confirm('削除しますか？');">
              <button type="submit">削除</button>
            </form>
          </td>
      </tr>
      {% endfor %}
  </table>

  <p><a href="/">← 在庫一覧に戻る</a></p>
{% endblock %}
